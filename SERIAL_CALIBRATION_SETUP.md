# 串口自标定功能设置说明

## 已完成的功能

我已经实现了以下功能：

1. ✅ **串口连接模块** (`serial_comm.py`)
   - 连接到 COM16 串口
   - 支持可配置的波特率（默认 115200）

2. ✅ **发送标定模式指令**
   - `enter_calibration_mode()` - 进入标定模式
   - `exit_calibration_mode()` - 退出标定模式

3. ✅ **接收串口数据**
   - 自动解析多种数据格式（JSON、CSV、文本）
   - 提取 anchor 之间的测距数据

4. ✅ **集成到主应用**
   - 标定对话框已更新为使用串口通信
   - 自动数据采集和显示

## 需要您提供的信息

为了完整实现功能，我需要以下信息：

### 1. 进入标定模式的串口指令格式

请提供发送给硬件进入标定模式的指令格式。常见格式包括：

**选项 A: ASCII 文本格式**
```
例如: "CALIBRATE\r\n" 或 "CAL\r\n" 或 "ENTER_CAL_MODE\r\n"
```

**选项 B: 十六进制格式**
```
例如: [0x01, 0x02, 0x03] 或 b'\x01\x02\x03'
```

**选项 C: 其他格式**
```
请提供具体的指令格式
```

### 2. 退出标定模式的串口指令格式

请提供退出标定模式的指令格式。

### 3. 硬件返回的数据格式

当硬件进入标定模式后，它会通过串口发送 anchor 之间的测距数据。请提供数据格式：

**选项 A: JSON 格式**
```json
{"AnchorI": 0, "AnchorJ": 1, "Distance": 25000}
```

**选项 B: CSV 格式**
```
0,1,25000
```

**选项 C: 文本格式**
```
A0-A1: 25000mm
或
0-1: 25000
```

**选项 D: 二进制格式**
```
请提供字节序列和解析方法
```

### 4. 波特率和其他串口参数

- 波特率：当前设置为 115200，是否正确？
- 数据位：8 位
- 停止位：1 位
- 校验位：无校验
- 流控：无

如果这些参数不正确，请告知正确的值。

## 当前实现

当前代码中，我使用了默认值：

```python
# 进入标定模式（需要替换为实际指令）
command = b"CALIBRATE\r\n"

# 退出标定模式（需要替换为实际指令）
command = b"EXIT_CAL\r\n"
```

数据解析支持多种格式，但如果您的硬件使用特殊格式，请提供详细信息。

## 如何测试

1. 安装依赖：
```bash
pip install pyserial
```

2. 运行程序并打开标定对话框

3. 点击 "Start Collection" 按钮

4. 观察串口连接和数据接收情况

## 下一步

请提供上述信息，我将更新代码以匹配您的硬件规格。

